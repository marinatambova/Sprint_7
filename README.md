# Проект: Автоматизация тестирования API сервиса Яндекс Самокат

## Описание проекта

В данном проекте проведена автоматизация тестирования API учебного сервиса **Яндекс Самокат**. Целью проекта является проверка корректной работы основных функций сервиса посредством написания автотестов.

Покрыты следующие ручки (эндпоинты) API:

1. **Создание курьера** (`POST /api/v1/courier`)
2. **Авторизация курьера** (`POST /api/v1/courier/login`)
3. **Создание заказа** (`POST /api/v1/orders`)
4. **Получение списка заказов** (`GET /api/v1/orders`)

Тесты были написаны с использованием библиотеки `pytest` и библиотеки `requests` для отправки HTTP-запросов. Для генерации отчетов о тестировании использовался **Allure Framework**.

## Структура проекта

```plaintext
Sprint_7/
├── tests/
│   ├── __init__.py
│   ├── test_create_courier.py
│   ├── test_courier_login.py
│   ├── test_create_order.py
│   └── test_get_orders_list.py
├── utils.py
├── config.py
├── data.py
├── expected_results.py
├── generate_random_string.py
├── conftest.py
├── requirements.txt
├── README.md
├── pytest.ini
└── другие файлы...

tests/ — каталог с тестами для каждого эндпоинта API.
utils.py — вспомогательные функции для работы с API (создание и удаление курьеров, заказов и т.д.).
config.py — файл с настройками и константами (базовый URL и эндпоинты API).
data.py — шаблоны данных (payload) для запросов.
expected_results.py — ожидаемые результаты (например, сообщения об ошибках).
generate_random_string.py — функция генерации случайных строк.
conftest.py — файл с фикстурами pytest.
requirements.txt — список зависимостей проекта.
pytest.ini — конфигурационный файл pytest с зарегистрированными метками (markers).
README.md — данный файл с описанием проекта.


Описание тестов
1. Тесты для эндпоинта "Создание курьера"
Позитивные тесты:

Успешное создание курьера с корректными данными.
Негативные тесты:

Попытка создания курьера без обязательного поля login.
Попытка создания курьера без обязательного поля password.
Попытка создания курьера с уже существующим login.
2. Тесты для эндпоинта "Авторизация курьера"
Позитивные тесты:

Успешная авторизация курьера с корректными данными.
Негативные тесты:

Попытка авторизации без обязательного поля login.
Попытка авторизации без обязательного поля password.
Попытка авторизации с неверным паролем.
Попытка авторизации под несуществующим пользователем.
Известная проблема:

Ошибка 504 Gateway Timeout при отсутствии поля password

При попытке авторизоваться без поля password сервер возвращает код ошибки 504 Gateway Timeout. Это означает, что сервер не отвечает вовремя на запрос.

Решение:

Данный тест помечен как ожидаемо падающий с помощью pytest.xfail, так как проблема, вероятно, на стороне сервера.
3. Тесты для эндпоинта "Создание заказа"
Позитивные тесты:

Создание заказа с указанием одного из цветов ("BLACK" или "GREY").
Создание заказа с указанием обоих цветов.
Создание заказа без указания цвета.
Параметризация:

Тесты на создание заказа с разными вариантами поля color выполнены с использованием параметризации pytest.
4. Тесты для эндпоинта "Получение списка заказов"
Позитивные тесты:

Успешное получение списка заказов.
Проверка структуры ответа и наличия необходимых полей.
Конфигурация pytest и метки (markers)
В файле pytest.ini зарегистрированы метки для запуска групп тестов:


# pytest.ini

[pytest]
markers =
    create_courier: тесты для создания курьера
    courier_login: тесты для авторизации курьера
    create_order: тесты для создания заказа
    get_orders_list: тесты для получения списка заказов
Запуск группы тестов по метке:

Например, чтобы запустить только тесты для создания курьера:


pytest -m create_courier
Фикстуры и вспомогательные функции
conftest.py: содержит фикстуру new_courier, которая создаёт нового курьера перед каждым тестом и удаляет его после выполнения теста.
utils.py: содержит функции для взаимодействия с API, такие как create_courier, login_courier, delete_courier и другие.
config.py: содержит базовый URL и пути к эндпоинтам API.
data.py: содержит шаблоны данных (payload) для различных запросов.
expected_results.py: содержит ожидаемые сообщения из ответов API.
generate_random_string.py: содержит функцию generate_random_string для генерации случайных строк, используемых в тестах.
Тестовые данные
Для генерации уникальных тестовых данных используется функция generate_random_string().
Шаблоны данных для запросов хранятся в файле data.py.
Очистка тестовых данных
Все создаваемые в процессе тестирования курьеры и заказы удаляются после выполнения тестов, чтобы не загрязнять базу данных сервера.
Известные проблемы и их решение
Ошибка 504 Gateway Timeout при авторизации без поля password:

Проблема, вероятно, на стороне сервера.
Тест помечен как xfail с соответствующим сообщением.
Рекомендуется сообщить разработчикам о данной проблеме для её устранения.
Требования
Python 3.7 или выше
pytest
requests
allure-pytest
pytest-ordering
Все необходимые зависимости устанавливаются из файла requirements.txt.

Контактная информация
Автор: Тамбова Марина Юрьевна

GitHub: myutambova
Заключение
Данный проект демонстрирует навыки автоматизации тестирования API с использованием фреймворка pytest и показывает умение работать с HTTP-запросами, обрабатывать ответы сервера и генерировать отчеты о тестировании с помощью Allure.